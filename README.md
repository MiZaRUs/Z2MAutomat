# Домашняя автоматика
Для работы с сетями zigbee используется мост Zigbee2MQTT [https://www.zigbee2mqtt.io/]

Если Вы точно знаете что хотите от автоматики, то универсальные решения могут сильно ограничить Вашу фантазию)
Поэтому было принято решение всю автоматику реализовать в коде в одном файле (exec_rules.go)
Архитектура модульная: "z2m_automation" основной сервис, а остальное по требованию.
Всё это работает в docker-контейнерах на стареньком недобуке eee-1000H.

# ВАЖНО!
## Всё это рассчитано на работу в локальной сети, так-как доступы не защищены!
Если нужен внешний доступ, обязательно позаботьтесь о защищенном шлюзе.

## z2m_automation
Микросервис обработки данных и автоматика (golang).
Получает по подписке данные с mqtt-сервиса, анализирует событие и выполняет требуемые действия.
Так-же можно некоторые данные отправить по UDP в сервис мониторинга.

## z2m_monitoring
Микросервис мониторинга и временного хранения данных (golang).
Предоставляет REST API, в будущем возможно будет Web-интерфейс для отображения аварий и др.
БД встроенная. Хранение данных ограничено по времени, повторы значений при записи - игнорируются.

## graphmon
Qt-Приложение для визуализации данных в виде графиков для анализа и выявления зависимостей.
Может быть полезно при анализе освещённости для настройки автоматической работы светильников.
Данные получает по REST с сервиса мониторинга.

## util
Вспомогательные утилиты.

## Скрипты компиляции, сбори контейнера и деплоя (требуется go)
- build_SA_in_docker_386.sh
- build_SM_in_docker_386.sh
Данные скрипты легко подправить под любую поддерживаемую архитектуру.
Go используется в режиме: GO111MODULE=off
Базовый образ докера: "scratch" - так что места много не займет)

## Сборка приложения (требуется Qt для разработчиков и C++)
build_graphmonitor.sh

В директории doc есть подсказки по mosquitto.
